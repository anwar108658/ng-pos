<div class="fixed top-0 right-0 flex w-full h-screen bg-white z-30 text-black">
  <!-- Left Side-->
  <div class="w-[55%] p-2">
    <!-- upper -->
    <div class="scrollCs h-[80%] border-2 border-gray-200 overflow-auto">
      <p-table [value]="addCartProducts" size="small" selectionMode="single" showGridlines (onRowSelect)="getQty($event)" [(selection)]="selectedRow" dataKey="id">
        <ng-template #header>
          <tr>
            <th>Item</th>
            <th>Qty</th>
            <th>Before D</th>
            <th>Unit Price</th>
            <th>Total Price</th>
            <th>Act</th>
          </tr>
        </ng-template>
        <ng-template #body let-item>
          <tr class="text-center text-[.8rem] border border-gray-300" [pSelectableRow]="item">
            <td class="flex gap-3 px-1 items-center">
              <div>
                <img src="assets/logo.png" width="30" alt="" />
              </div>
              <div class="whitespace-nowrap overflow-auto scrollCs">
                <p class="font-semibold">{{ item.itemCode }} | {{ item.productName }}</p>
                <span
                  >Unit Price: {{ item.price| currency}} | Discount {{ item.discount }}</span
                >
              </div>
            </td>
            <td>{{ item.qty }}</td>
            <td>{{ item.price |currency}}</td>
            <td>{{ item?.uOm?.code}}</td>
            <td>{{ item.qty * item.price | currency}}</td>   
            <td>
              <p-button
                (onClick)="deleteProduct(item.id)"
                icon="pi pi-trash"
                variant="text"
                severity="danger"
                styleClass="p-0"
                size="small"
              />
            </td>
          </tr>
        </ng-template>
      </p-table>
    </div>
    <!-- lower -->
    <div class="h-[20%] m-1 p-1 bg-cyan-50 flex justify-between">
      <div class="max-w-[30%] text-[.9rem] font-semibold text-gray-800 whitespace-nowrap">
        <p class="flex justify-between"><span>Sub Total : </span><span>{{addCartSum.subTotal|currency}}</span></p>
        <p class="flex justify-between">
          <p-button
            (onClick)="toggleCoupon($event)"
            size="small"
            styleClass="p-0"
            variant="text"
            severity="info"
            [label]="'% Discount'"
          /><span class="text-green-700">{{ selectCouponVal / 100 | percent }}</span>
        </p>
        <p-popover styleClass="w-full max-w-90" #op>
          <div class="p-2">
            <div class="mb-2">
              <span class="font-medium block mb-2">Coupons</span>
              <input
                placeholder="Search Coupons"
                (input)="searchCoupons($event)"
                class="w-full"
                pSize="small"
                pInputText
              />
            </div>
            <ul class="w-full max-h-50 overflow-auto grid grid-cols-3 gap-2">
              @for (item of filterCoupons; track $index) {
              <li
                (click)="selectCoupon(item.amount)"
                class="h-12 flex flex-col gap-1 col-span-1 bg-blue-100/10 p-1 rounded-md text-[.8rem] cursor-pointer"
              >
                <span class="font-semibold">{{ item?.couponName }}</span>
                <p class="bg-green-600 text-gray-200 rounded-2xl px-2 text-[.7rem]">
                  Discount {{ item?.amount / 100 | percent }}
                </p>
              </li>
              }
            </ul>
          </div>
        </p-popover>
      </div>
      <div class="max-w-[30%] text-[1rem] font-bold text-blue-800 whitespace-nowrap">
        <p><span class="font-semibold">Item : </span> <span>{{addCartSum.items}}</span></p>
        <p><span>Net Amount</span></p>
        <p><sup>SAR </sup> <span>{{addCartSum.netAmount|currency}}</span></p>
      </div>
    </div>
  </div>

  <!-- Right Side-->
  <div class="w-[45%]">
    <!-- upper -->
    <div class="h-[65%] flex items-end bg-orange-100 p-2">
      <p-autocomplete
        placeholder="Search ItemCode"
        fluid
        styleClass="w-full"
        [(ngModel)]="selectedProductsAdvanced"
        (onKeyUp)="onKeyUp($event)"
        [suggestions]="filteredProducts"
        (completeMethod)="filterproducts($event)"
        optionLabel="itemCode"
      >
        <ng-template class="border-b!" style="border-bottom: 2px solid" let-product #item>
          <div class="w-full flex items-center justify-between gap-2 text-[.8rem] text-gray-700">
            <div class="flex items-center gap-3">
              <div><img src="assets/logo.png" width="30" alt="image" /></div>
              <div>
                <p class="font-bold">{{ product.productName }}</p>
                <p>{{ product.category }}</p>
              </div>
            </div>
            <p class="underline">#{{ product.itemCode }}</p>
            <div>
              <p class="flex items-center gap-2">
                <span class="pi pi-indian-rupee text-[.7rem]"></span>
                <span class="text-green-500">{{ product.price }}</span>
              </p>
            </div>
          </div>
        </ng-template>
        <ng-template #header>
          <div class="font-medium px-3 py-2">Available Products</div>
        </ng-template>
      </p-autocomplete>
    </div>
    <!-- Lower -->
    <div class="h-[35%] grid grid-cols-8">
      <div class="flex flex-col col-span-3 bg-blue-50 p-1">
        <p class="font-semibold text-[.9rem] text-amber-700">Set Quantity :</p>
        <input [(ngModel)]="selectQty" type="text" readonly pInputText pSize="small" />
        <div class="h-full p-1 grid grid-cols-4 gap-1 grid-rows-4">
          @for (item of calculateNum; track $index) {
          <div [class]="item.class">
            <p-button
              variant="outlined"
              severity="primary"
              [styleClass]="'w-full h-full'"
              size="small"
              (onClick)="setQty(item.id)"
              [label]="item.id.toString()"
            />
          </div>
          }
        </div>
      </div>
      <div class="col-span-5 grid grid-cols-4 grid-rows-4 gap-1 p-1 overflow-auto scrollCs">
        @for (item of posButtons; track $index) {
        <button [class]="getButtonClasses(item)">{{ item.label }}</button>
        }
      </div>
    </div>
  </div>
</div>
